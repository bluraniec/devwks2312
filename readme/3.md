## Chapter 2 - Telemetry Application Stack 2/3: COLLECTOR

> :white_check_mark: We know already how to configure Telemetry on IOS-XR and Database in order to store that data.  
> :arrow_down: Now it's the time to setup the collection itself! :clap: <br>

**Pipeline** is already downloaded for you.  
For your own usage, you can download it from here - https://github.com/cisco/bigmuddy-network-telemetry-pipeline

### 1st step - Pipeline.conf: INPUT
Default configuration provided in this file allows to listen to incoming streams on the port **5432**.  
We don't need to change it.

### 2nd step - Pipeline.conf: OUTPUT
Append to the *pipeline.conf* file place where we want to send further coming streams:
```
[mymetrics]
stage = xport_output
type = metrics
file = /root/bigmuddy-network-telemetry-pipeline/metrics.json
output = influx
influx = http://198.18.133.212:8086
database = TELEMETRY_DATA
```

### 3rd step - Metrics.json
Go out from the bin folder:
```
root@ubuntu:~/# cd ..
```
In order to specify exact metrics that we are interested to push to the database (from the YANG Data Model) â€“ edit metrics.json file as following:
```
[
  {
    "basepath" : "Cisco-IOS-XR-ipv4-bgp-oper:bgp/instances/instance/instance-active/default-vrf/neighbors/neighbor",
    "spec" : {
      "fields" : [
         {"name" : "neighbor-address", "tag" : true},
         {"name" : "connection-state"}
      ]
    }
  }								
]
```

### 4th step - Run Pipeline
In the CLI issue command influx to run the InfluxDB:
```
root@ubuntu:~/# cd /home/Desktop/bigmuddy-network-pipeline/bin
```
```
root@ubuntu:~/bigmuddy-network-pipeline/bin# ./pipeline -log= --debug
```

---
<h4 align="center">[4/8]</h4>
<h4 align="center"> <a href="/readme/2.md"> :arrow_left: Telemetry Application Stack 1/3 </a> || <a href="/readme/4.md"> Telemetry Application Stack 3/3 :arrow_right: </a> </h4>
